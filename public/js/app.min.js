function LandingView(){View.call(this),this.Init=function(){function a(){window.lineChart&&(window.lineChart.destroy(),window.barChart.destroy(),$(c.ChartCarousel).trigger("slid.bs.carousel")),window.polarChart&&(window.polarChart.destroy(),window.radarChart.destroy(),$(c.ChartCarousel).trigger("slid.bs.carousel"))}function b(){d.LineChart(c.Charts.Line[0]),d.BarChart(c.Charts.Bar[0])}var c=new LandingComponents,d=new ChartFactory;$(c.Navigation).on("mouseover",function(a){$(this).addClass("flash")}),$(c.Navigation).on("mouseleave",function(a){$(this).removeClass("flash")}),$(c.FeaturedContent).on("mouseover",function(a){var b=$(this).find(".feature-circle").first();$(b).removeClass("spin"),$(b).addClass("spin")}),$(c.Sections).on("viewport:enter",function(a){if("siteFeatures"===$(this).prop("id")){var b=$(".feature-circle");$(b).animate({opacity:"1"},{duration:500,complete:function(){$(this).addClass("spin")}})}}),$(c.Sections).on("viewport:exit",function(a){if(console.log("a section left the viewport"),"siteFeatures"===$(this).prop("id")){var b=$(".feature-circle");$(b).animate({opacity:"0"},{duration:500,complete:function(){$(this).removeClass("spin")}})}}),$(window).scroll(function(a){var b=$(c.Sections);$(b).each(function(a){$(this).inView()&&!$(this).hasClass("jq")?($(this).addClass("jq"),$(this).trigger("viewport:enter")):!$(this).inView()&&$(this).hasClass("jq")&&($(this).removeClass("jq"),$(this).trigger("viewport:exit"))})});var e;$(window).resize(function(){clearTimeout(e),e=setTimeout(a,500)}),$(c.ChartCarousel).on("slide.bs.carousel",function(a){var b=$(this).find(".item.active");$(b).animate({opacity:"0.0"},500,function(){var b=a.relatedTarget;$(b).animate({opacity:"1.0"},500)})}),$(c.ChartCarousel).on("slid.bs.carousel",function(a){$(c.Charts.Line).is(":visible")?(d.LineChart(c.Charts.Line[0]),d.BarChart(c.Charts.Bar[0])):(d.PolarChart(c.Charts.Polar[0]),d.RadarChart(c.Charts.Radar[0]))}),b()}}function ProfileView(){View.call(this),this.Init=function(){var a=new ProfileComponents,b=this.CSRF,c=this.USER_ID;$(a.Modals.AddPhoto).on("shown.bs.modal",function(a){function d(){var a=$(j).find("img");a.length?$(k).is(":visible")&&($(k).hide(),$(n).hide()):($(k).show(),$(n).hide(),$(o).prop("disabled",!0))}function e(a){$(j).prepend(a),$(o).prop("disabled",!1),d()}var f=$(this),g=f.find(".file-dropper"),h=f.find("#photoFromUrlField"),i=f.find("#photoFromFileField"),j=f.find(".img-preview-list"),k=j.find("h6"),l=f.find(".form-group").first(),m=f.find("#urlStatus"),n=f.find(".btn-xs"),o=f.find("#submitPhotoUpload");FileHandler.init(),d(),$(h).bind("input change",function(a){var b=$(this).val();$.trim(b)?b.match(Patterns.imgUrl())?ImageFactory(b).thumbnail(function(a){FormDecorator.okThenClear(l,m),e(a),$(h).val("")},function(a){FormDecorator.error(l,"Image failed to load.",m)}):FormDecorator.warn(l,"Invalid image URL",m):FormDecorator.clear(l,m)}),$(j).on("click","img",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected"),$(n).show()}),$(n).on("click",function(){for(var a=$(j).children(),b=0;b<a.length;b++)$(a[b]).hasClass("selected")&&($(a[b]).remove(),d())}),$(i).on("change",function(a){FileHandler.read(a,"\\image.*",function(a){ImageFactory(a).thumbnail(function(a){e(a)})})}),$(g).on("dragover",function(a){a.stopPropagation(),a.preventDefault(),FileHandler.copy(a),$(this).addClass("drop")}),$(g).on("dragleave",function(a){$(this).removeClass("drop")}),$(g).on("drop",function(a){a.stopPropagation(),a.preventDefault(),FileHandler.readDropped(a,"\\image.*",function(a){ImageFactory(a).thumbnail(function(a){e(a)})}),$(this).removeClass("drop")}),$(submitPhotoUpload).on("click",function(){for(var a=$(j).find("img"),e=[],f=0;f<a.length;f++)e[f]=$(a[f]).attr("src");AjaxHandler(function(b){$("#uploadNotify").text(b.upload_count+" photo(s) uploaded successfully"),$(a).remove(),d()},b,c).post("photos/upload",{photos:e})})}),$(a.Modals.AddPhoto).on("hidden.bs.modal",function(a){$(this).find("#photoFromUrlField").off("input change"),$(this).find("#photoFromFileField").off("change"),$(this).find("#submitPhotoUpload").off("click"),$(this).find("#uploadNotify").text(""),$(this).find(".file-dropper").off("dragover dragleave drop"),$(this).find(".img-preview-list").off("click","img")}),$(a.Modals.About).on("shown.bs.modal",function(a){var d=$("#aboutText").text(),e=$(this),f=e.find("textarea"),g=e.find(".form-group"),h=$("#submitAboutEdit");$(f).text(d),$(f).focus(),$(f).bind("input change",function(){$.trim($(f).val())?(FormDecorator.clear(g),$(h).prop("disabled",!1)):(FormDecorator.error(g,"This is a required field."),$(h).prop("disabled",!0))}),$(h).click(function(){if(!$(g).hasClass("has-error")){var a={data:$(f).val()};AjaxHandler(function(a){$($.parseHTML(a)).appendTo("#aboutText"),FormDecorator.ok($(g),"Update sucessful"),$(h).prop("disabled",!0)},b,c).post("about",a)}})}),$(a.Modals.About).on("hidden.bs.modal",function(a){FormDecorator.clear($(this).find(".form-group"))}),$(a.Modals.ViewPhoto).on("shown.bs.modal",function(a){function b(a){var b=$(e).clone();a.id==d&&$(b).addClass("active"),$(b).prepend(a),$(f).append(b)}function c(){var a=$(".user-photos").find("a").find("img").clone();$(a).removeClass("img-thumbnail").addClass("img-responsive");for(var c=0;c<a.length;c++)b(a[c])}var d=$(this).find("#sender").val(),e=$(this).find(".item").first(),f=$(this).find(".carousel-inner"),g=($(this).find(".left"),$(this).find(".right"),e);$(e).remove(),c(),$(this).on("hide.bs.modal",function(a){$(this).find(".item").remove(),$(this).append(g)})}),$(a.Modals.ViewPhoto).on("hidden.bs.modal",function(a){$(this).find("#sender").val("")}),$(a.Content.Photos).ready(function(){function b(a){var b=$("<a></a>").attr("href","#");$(b).append(a),$(".user-photos").append(b)}function d(){$(".user-photos").find("img").remove(),$.get("photos/get",{id:c},function(a){for(var c in a.photos)ImageFactory(a.photos[c].photo_src,a.photos[c].photo_id).thumbnail(function(a){b(a)})})}$(".user-photos").on("click","a",function(b){b.stopPropagation(),b.preventDefault();var c=$(this).find("img").attr("id");$(a.Modals.ViewPhoto).find("#sender").val(c),$(a.Modals.ViewPhoto).modal("show")}),$(a.Content.About).ready(function(){var a=$("#aboutText"),b=$(a).text();$(a).empty(),$($.parseHTML(b)).appendTo("#aboutText")}),d()})}}function View(){this.CSRF=$("meta[name='csrf_token']").attr("content"),this.USER_ID=$("meta[name='user_id']").attr("content")}var randomScalingFactor=function(){return Math.round(100*Math.random())},lineChartData={labels:["January","February","March","April"],datasets:[{label:"New Users",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:[randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]},{label:"New Posts",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:[randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]}]},barChartData={labels:["Math","Comp Sci","Politics","Biology"],datasets:[{fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:[randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]},{fillColor:"rgba(151,187,205,0.5)",strokeColor:"rgba(151,187,205,0.8)",highlightFill:"rgba(151,187,205,0.75)",highlightStroke:"rgba(151,187,205,1)",data:[randomScalingFactor(),randomScalingFactor(),randomScalingFactor(),randomScalingFactor()]}]},polarData=[{value:300,color:"#F7464A",highlight:"#FF5A5E",label:"Red"},{value:50,color:"#46BFBD",highlight:"#5AD3D1",label:"Green"},{value:100,color:"#FDB45C",highlight:"#FFC870",label:"Yellow"},{value:40,color:"#949FB1",highlight:"#A8B3C5",label:"Grey"},{value:120,color:"#4D5360",highlight:"#616774",label:"Dark Grey"}],radarChartData={labels:["Eating","Drinking","Sleeping","Designing","Coding","Cycling","Running"],datasets:[{label:"My First dataset",fillColor:"rgba(220,220,220,0.2)",strokeColor:"rgba(220,220,220,1)",pointColor:"rgba(220,220,220,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(220,220,220,1)",data:[65,59,90,81,56,55,40]},{label:"My Second dataset",fillColor:"rgba(151,187,205,0.2)",strokeColor:"rgba(151,187,205,1)",pointColor:"rgba(151,187,205,1)",pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:"rgba(151,187,205,1)",data:[28,48,40,19,96,27,100]}]},ChartFactory=function(){return{LineChart:function(a){var b=a.getContext("2d");window.lineChart=new Chart(b).Line(lineChartData,{responsive:!1,animation:!0,barValueSpacing:5,barDatasetSpacing:1,showTooltips:!1,tooltipFillColor:"rgba(0,0,0,0.8)",multiTooltipTemplate:"<%= datasetLabel %> - <%= value %>"})},BarChart:function(a){var b=a.getContext("2d");window.barChart=new Chart(b).Bar(barChartData,{responsive:!1,showTooltips:!1})},PolarChart:function(a){var b=a.getContext("2d");window.polarChart=new Chart(b).PolarArea(polarData,{responsive:!1,showTooltips:!1})},RadarChart:function(a){window.radarChart=new Chart(a.getContext("2d")).Radar(radarChartData,{responsive:!1,showTooltips:!1})}}},ChartType={Line:1,Bar:2,Polar:3,Radar:4},FileHandler={init:function(){jQuery.event.props.push("dataTransfer")},copy:function(a){a.dataTransfer.dropEffect="copy"},read:function(a,b,c){for(var d,e=a.target.files,f=0;d=e[f];f++)if(d.type.match(b)){var g=new FileReader;g.onload=function(a){c(a.target.result)},g.readAsDataURL(d)}},readDropped:function(a,b,c){for(var d,e=a.dataTransfer.files,f=0;d=e[f];f++)if(d.type.match(b)){var g=new FileReader;g.onload=function(a){c(a.target.result)},g.readAsDataURL(d)}}},Patterns={imgUrl:function(){return new RegExp(/(https?:\/\/.*\.(?:png|jp?g))/i)}},ImageFactory=function(a,b){return{src:a,id:b,thumbnail:function(c,d){var e=new Image;e.src=a,e.className="img-thumbnail",b?e.id=b:0,e.onload=function(){c(e)},e.onerror=function(){d(a)}},responsive:function(c,d){var e=new Image;e.src=a,e.className="img-responsive",b?e.id=b:0,e.onload=function(){c(e)},e.onerror=function(){d(a)}}}},AjaxHandler=function(a,b,c){return{csrf:b,oncompl:a,id:c,post:function(d,e){e._token=b,e.id=c,$.ajax({type:"POST",url:d,data:e}).done(function(b){a(b)})}}},FormDecorator={warn:function(a,b,c){if($(a).removeClass("has-error has-success"),$(a).addClass("has-warning"),c&&($(a).addClass("has-feedback"),$(c).removeClass("glyphicon-ok glyphicon-remove"),$(c).addClass("glyphicon-warning-sign"),$(c).show()),b){var d=$(a).find(".help-block").first();$(d).text(b)}},ok:function(a,b,c){if($(a).removeClass("has-error has-warning"),$(a).addClass("has-success"),c&&($(a).addClass("has-feedback"),$(c).removeClass("glyphicon-warning-sign glyphicon-remove"),$(c).addClass("glyphicon-ok"),$(c).show()),b){var d=$(a).find(".help-block").first();$(d).text(b)}},error:function(a,b,c){if($(a).removeClass("has-warning has-success"),$(a).addClass("has-error"),c&&($(a).addClass("has-feedback"),$(c).removeClass("glyphicon-warning-sign glyphicon-remove"),$(c).addClass("glyphicon-remove"),$(c).show()),b){var d=$(a).find(".help-block").first();$(d).text(b)}},okThenClear:function(a,b){$(a).removeClass("has-error has-warning"),$(a).addClass("has-success"),b?($(a).addClass("has-feedback"),$(b).removeClass("glyphicon-warning-sign glyphicon-remove"),$(b).addClass("glyphicon-ok"),$(b).show("fast",function(){$(b).hide("slow",function(){$(a).removeClass("has-warning has-success has-error has-feedback")})})):$(a).removeClass("has-warning has-success has-error has-feedback")},clear:function(a,b){$(a).removeClass("has-warning has-success has-error has-feedback"),b&&($(b).removeClass("glyphicon-ok glyphicon-remove glyphicon-warning-sign"),$(b).hide());var c=$(a).find(".help-block").first();c&&$(c).text("")}};$.fn.inView=function(){var a=this[0].getBoundingClientRect();return!(a.bottom<0||a.right<0||a.left>window.innerWidth||a.top>window.innerHeight)},$.fn.sleep=function(a){return $.Deferred(function(b){setTimeout(b.resolve,a)})};var ProfileComponents=function(){return{Modals:{About:$("#editAboutMod"),AddPhoto:$("#addPhotoMod"),ViewPhoto:$("#viewPhotoMod")},Content:{Photos:$("#photoContent"),About:$("#aboutText")}}},LandingComponents=function(){return{Navigation:$(".landing-nav-link"),ChartCarousel:$("#chartCarousel").carousel({interval:3e3,pause:"hover"}),Charts:{Line:$("#lineChartCanvas"),Bar:$("#barChartCanvas"),Polar:$("#polarChartCanvas"),Radar:$("#radarChartCanvas")},FeaturedContent:$(".featured-content"),Sections:$("section")}};